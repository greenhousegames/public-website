{"version":3,"sources":["app/app.js","app/config.js","app/firebase-client.js","app/reporting/heartbeat.js","app/reporting/index.js","app/reporting/smashdot.js"],"names":["document","foundation","client","firebase","auth","onAuthStateChanged","user","isAnonymous","loginSuccess","hideAuth","window","GreenhouseGames","root","jQuery","addClass","account","initAccountPage","reporting","initGamePage","i","s","o","g","r","a","m","q","push","arguments","l","Date","createElement","getElementsByTagName","async","src","parentNode","insertBefore","ga","showAuth","show","hide","text","data","image","attr","photoURL","name","displayName","loginError","err","console","log","buttons","logout","click","signOut","then","catch","twitter","signInWithPopup","facebook","google","github","Reporting","require","report","loadCharts","ready","draw","resize","module","exports","apiKey","authDomain","databaseURL","storageBucket","messagingSenderId","staticFirebase","FirebaseClient","initializeApp","currentUser","uid","provider","GoogleAuthProvider","FacebookAuthProvider","TwitterAuthProvider","GithubAuthProvider","promise","Promise","resolve","callback","off","reject","waitForAuth","signInAnonymously","database","ref","done","charts","load","setOnLoadCallback","requireAuth","_drawGamePlayed","_drawUsersPlayed","_drawLastPlayed","filter","sum","select","values","count","total","last","date","setTime","toISOString","timeago","_drawClassicRankings","_drawSurvivalRankings","_drawMaxScores","_drawModesPlayed","max","value","currentUID","mode","pr","greater","min","all","element","visualization","arrayToDataTable","options","title","width","height","pieHole","legend","position","chart","PieChart","ColumnChart"],"mappings":"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","file":"public/assets/js/app.js","sourcesContent":["import $ from 'jquery';\nimport './reporting';\nimport FirebaseClient from './firebase-client';\n\n$(document).foundation();\n\nconst client = new FirebaseClient();\nclient.firebase.auth().onAuthStateChanged((user) => {\n  if (user && !user.isAnonymous) {\n    loginSuccess({user: user});\n  } else {\n    hideAuth();\n  }\n});\n\nif (!window.GreenhouseGames.root) {\n  jQuery('section.main').addClass('subpage');\n}\n\nif (window.GreenhouseGames.account) {\n  initAccountPage();\n}\n\nif (window.GreenhouseGames.reporting) {\n  initGamePage();\n}\n\n// Google Analytics\n(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){\n(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),\nm=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)\n})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');\n\nga('create', 'UA-85526007-1', 'auto');\nga('send', 'pageview');\n\n/*\n * AUTH HELPERS\n */\nfunction showAuth() {\n  jQuery('.show-auth').show();\n  jQuery('.hide-auth').hide();\n}\n\nfunction hideAuth() {\n  jQuery('.hide-auth').show();\n  jQuery('.show-auth').hide();\n  jQuery('span.user-name').text('Login');\n}\n\nfunction loginSuccess(data) {\n  if (window.GreenhouseGames.account) {\n    jQuery('#' + window.GreenhouseGames.account.user.image).attr('src', data.user.photoURL);\n    jQuery('#' + window.GreenhouseGames.account.user.name).text(data.user.displayName);\n  }\n  jQuery('span.user-name').text(data.user.displayName);\n  showAuth();\n}\n\nfunction loginError(err) {\n  console.log(err);\n}\n\n/*\n * PAGE HELPERS\n */\nfunction initAccountPage() {\n  // init buttons\n  jQuery('#' + window.GreenhouseGames.account.buttons.logout).click(() => client.signOut().then(hideAuth).catch(hideAuth));\n  jQuery('#' + window.GreenhouseGames.account.buttons.twitter).click(() => client.signInWithPopup('twitter').then(loginSuccess).catch(loginError));\n  jQuery('#' + window.GreenhouseGames.account.buttons.facebook).click(() => client.signInWithPopup('facebook').then(loginSuccess).catch(loginError));\n  jQuery('#' + window.GreenhouseGames.account.buttons.google).click(() => client.signInWithPopup('google'));\n  jQuery('#' + window.GreenhouseGames.account.buttons.github).click(() => client.signInWithPopup('github').then(loginSuccess).catch(loginError));\n}\n\nfunction initGamePage() {\n  var Reporting = require('reporting/' + window.GreenhouseGames.reporting + '.js');\n  var report = new Reporting();\n  report.loadCharts(() => {\n    $(document).ready(() => {\n      report.draw();\n\n      $(window).resize(() => {\n        report.draw();\n      });\n    });\n  });\n}\n","module.exports = {\n  apiKey: 'AIzaSyCqcbh9XmZZBahTDxmj4GXbwQny9H9wHdo',\n  authDomain: 'greenhouse-games-test.firebaseapp.com',\n  databaseURL: 'https://greenhouse-games-test.firebaseio.com',\n  storageBucket: '',\n  messagingSenderId: '756331628096'\n};\n","import firebase from 'firebase';\nimport rsvp from 'rsvp';\nimport config from './config';\n\nlet staticFirebase = null;\n\nclass FirebaseClient {\n  constructor() {\n    if (!staticFirebase) {\n      staticFirebase = firebase.initializeApp(config);\n    }\n    this.firebase = staticFirebase;\n  }\n\n  currentUID() {\n    return this.firebase.auth().currentUser ? this.firebase.auth().currentUser.uid : null;\n  }\n\n  signOut() {\n    return this.firebase.auth().signOut();\n  }\n\n  signInWithPopup(name) {\n    let provider;\n    switch (name) {\n      case 'google':\n        provider = new firebase.auth.GoogleAuthProvider();\n        break;\n      case 'facebook':\n        provider = new firebase.auth.FacebookAuthProvider();\n        break;\n      case 'twitter':\n        provider = new firebase.auth.TwitterAuthProvider();\n        break;\n      case 'github':\n        provider = new firebase.auth.GithubAuthProvider();\n        break;\n      default:\n        console.log('Provider \"' + name + '\" is not support');\n        return;\n    }\n\n    return this.firebase.auth().signInWithPopup(provider);\n  }\n\n  waitForAuth() {\n    const auth = this.firebase.auth();\n    const promise = new rsvp.Promise((resolve) => {\n      const callback = () => {\n        off();\n        resolve();\n      };\n      const off = auth.onAuthStateChanged(callback);\n    });\n    return promise;\n  }\n\n  requireAuth() {\n    const promise = new rsvp.Promise((resolve, reject) => {\n      this.waitForAuth().then(() => {\n        if (!this.firebase.auth().currentUser) {\n          this.firebase.auth().signInAnonymously().then(resolve).catch(reject);\n        } else {\n          resolve();\n        }\n      }).catch(reject);\n    });\n    return promise;\n  }\n}\n\nmodule.exports = FirebaseClient;\n","import GameReporting from '@greenhousegames/heartbeat/dist/reporting';\nimport FirebaseClient from '../firebase-client';\nimport rsvp from 'rsvp';\n\nclass Reporting extends FirebaseClient {\n  constructor() {\n    super();\n    this.reporting = new GameReporting(this.firebase.database().ref('games/heartbeat/data'), this.firebase.database().ref('games/heartbeat/reporting'));\n  }\n\n  loadCharts(done) {\n    google.charts.load('current', {'packages':['corechart']});\n    google.charts.setOnLoadCallback(done);\n  }\n\n  draw() {\n    this.requireAuth().then(() => {\n      // metrics\n      this._drawGamePlayed();\n      this._drawUsersPlayed();\n      this._drawLastPlayed();\n    });\n  }\n\n  _drawGamePlayed() {\n    this.reporting.filter().sum('played').select(1).then(function(values) {\n      jQuery('#game_played_count').text(values[0] || 0);\n    }).catch(function(err) { console.log(err); });\n  }\n\n  _drawUsersPlayed() {\n    this.reporting.filter('users').sum('played').count().then(function(total) {\n      jQuery('#user_played_count').text(total);\n    }).catch(function(err) { console.log(err); });\n  }\n\n  _drawLastPlayed() {\n    this.reporting.filter().last('endedAt').select(1).then(function(values) {\n      if (!values[0]) {\n        jQuery('#last_played_timestamp').text('never');\n      } else {\n        var date = new Date();\n        date.setTime(values[0]);\n        jQuery('#last_played_timestamp').attr('datetime', date.toISOString());\n        jQuery('#last_played_timestamp').timeago();\n      }\n    }).catch(function(err) { console.log(err); });\n  }\n}\n\nmodule.exports = Reporting;\n","import './heartbeat';\nimport './smashdot';\n","import GameReporting from '@greenhousegames/smash-dot/dist/reporting';\nimport FirebaseClient from '../firebase-client';\nimport rsvp from 'rsvp';\n\nclass Reporting extends FirebaseClient {\n  constructor() {\n    super();\n    this.reporting = new GameReporting(this.firebase.database().ref('games/smashdot/data'), this.firebase.database().ref('games/smashdot/reporting'));\n  }\n\n  loadCharts(done) {\n    google.charts.load('current', {'packages':['corechart']});\n    google.charts.setOnLoadCallback(done);\n  }\n\n  draw() {\n    this.requireAuth().then(() => {\n      // metrics\n      this._drawGamePlayed();\n      this._drawUsersPlayed();\n      this._drawLastPlayed();\n\n      // rankings\n      this._drawClassicRankings();\n      this._drawSurvivalRankings();\n\n      // charts\n      this._drawMaxScores();\n      this._drawModesPlayed();\n    });\n  }\n\n  _drawClassicRankings() {\n    this.reporting.filter('users').max('classic-score').count().then((value) => {\n      jQuery('#classic_ranking2').text('of ' + value);\n    }).catch(function(err) { console.log(err); });\n\n    this.reporting.filter('users-modes', {\n      uid: this.currentUID(),\n      mode: 'classic'\n    }).max('classic-score').value().then((pr) => {\n      if (pr) {\n        this.reporting.filter('users', {\n          uid: this.currentUID()\n        }).max('classic-score').greater(pr).count().then((value) => {\n          jQuery('#classic_ranking1').text('#' + value);\n        });\n      } else {\n        jQuery('#classic_ranking1').text('N/A');\n      }\n    }).catch(function(err) { console.log(err); });\n  }\n\n  _drawSurvivalRankings() {\n    this.reporting.filter('users').min('survival-duration').count().then((value) => {\n      jQuery('#survival_ranking2').text('of ' + value);\n    }).catch(function(err) { console.log(err); });\n\n    this.reporting.filter('users-modes', {\n      uid: this.currentUID(),\n      mode: 'survival'\n    }).min('survival-duration').value().then((pr) => {\n      if (pr) {\n        this.reporting.filter('users', {\n          uid: this.currentUID()\n        }).min('survival-duration').greater(pr).count().then((value) => {\n          jQuery('#survival_ranking1').text('#' + value);\n        });\n      } else {\n        jQuery('#survival_ranking1').text('N/A');\n      }\n    }).catch(function(err) { console.log(err); });\n  }\n\n  _drawGamePlayed() {\n    this.reporting.filter().sum('played').select(1).then(function(values) {\n      jQuery('#game_played_count').text(values[0] || 0);\n    }).catch(function(err) { console.log(err); });\n  }\n\n  _drawUsersPlayed() {\n    this.reporting.filter('users').sum('played').count().then(function(total) {\n      jQuery('#user_played_count').text(total);\n    }).catch(function(err) { console.log(err); });\n  }\n\n  _drawLastPlayed() {\n    this.reporting.filter().last('endedAt').select(1).then(function(values) {\n      if (!values[0]) {\n        jQuery('#last_played_timestamp').text('never');\n      } else {\n        var date = new Date();\n        date.setTime(values[0]);\n        jQuery('#last_played_timestamp').attr('datetime', date.toISOString());\n        jQuery('#last_played_timestamp').timeago();\n      }\n    }).catch(function(err) { console.log(err); });\n  }\n\n  _drawModesPlayed() {\n    rsvp.all([\n      this.reporting.filter('modes', { mode: 'survival' }).sum('played').value(),\n      this.reporting.filter('modes', { mode: 'classic' }).sum('played').value(),\n      this.reporting.filter('modes', { mode: 'battle' }).sum('played').value()\n    ]).then(function(values) {\n      var element = jQuery('#sum_played_chart');\n      var data = new google.visualization.arrayToDataTable([\n        ['Mode', 'Times Played'],\n        ['Survival', values[0] || 0],\n        ['Classic', values[1] || 0],\n        ['Battle', values[2] || 0]\n      ]);\n\n      // Set chart options\n      var options = {\n         title:'Modes Played',\n         width: element.width(),\n         height: 400,\n         pieHole: 0.4,\n         legend: { position: 'bottom' }\n      };\n\n      // Instantiate and draw our chart, passing in some options.\n      var chart = new google.visualization.PieChart(element[0]);\n      chart.draw(data, options);\n    }).catch(function(err) { console.log(err); });\n  }\n\n  _drawMaxScores() {\n    rsvp.all([\n      this.reporting.filter('modes', { mode: 'survival' }).max('survival-score').value(),\n      this.reporting.filter('modes', { mode: 'classic' }).max('classic-score').value(),\n      this.reporting.filter('modes', { mode: 'battle' }).max('battle-score').value()\n    ]).then(function(values) {\n      var element = jQuery('#max_score_chart');\n      var data = new google.visualization.arrayToDataTable([\n        ['Mode', 'Max Score'],\n        ['Survival', values[0] || 0],\n        ['Classic', values[1] || 0],\n        ['Battle', values[2] || 0]\n      ]);\n\n      // Set chart options\n      var options = {\n        title:'Max Scores',\n        width: element.width(),\n        height: 400,\n        legend: { position: 'bottom' }\n      };\n\n      // Instantiate and draw our chart, passing in some options.\n      var chart = new google.visualization.ColumnChart(element[0]);\n      chart.draw(data, options);\n    }).catch(function(err) { console.log(err); });\n  }\n}\n\nmodule.exports = Reporting;\n"]}